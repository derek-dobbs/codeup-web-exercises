<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Weather Map Project</title>
        <!-- Mapbox CSS -->
        <script src='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js'></script>
        <link href='https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css' rel='stylesheet' />
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
        <link rel="stylesheet" href="/css/weather_map.css">
        <style>
            /*header {*/
            /*    background-color: rgb(0, 116, 250);*/
            /*    color: white;*/
            /*    padding: .5em;*/
            /*}*/

            /*.card-heading {*/
            /*    background-color: rgb(247, 246, 246);*/
            /*    color: black;*/
            /*    text-align: center;*/
            /*    padding: .5em;*/
            /*    width: 100%;*/
            /*}*/

            /*button {*/
            /*    background-color: rgb(0, 116, 250);*/
            /*    color: white;*/
            /*}*/
        </style>
    </head>
    <body>
<!--        <header class="d-flex flex-row justify-content-center align-items-center">-->
<!--            <h4 class="flex-grow-1">Weather App</h4>-->
<!--            <div class="d-flex justify-content-center">-->
<!--                <p class="flex-grow-2" style="margin-bottom: 0 !important;">Current city: <span id="current-city">Place Holder</span></p>-->
<!--            </div>-->
<!--        </header>-->
<!--        <br>-->
<!--        <div class="d-flex flex-row" style="margin: 3em">-->
<!--            <label for="location-search" style="padding-right: 1em">Place </label>-->
<!--            <input id="location-search" type="text" placeholder="Enter location">-->
<!--            <button id="find-button" type="button" style="margin-left: 1em">Find</button>-->
<!--        </div>-->

<div class="jumbotron jumbotron-fluid" style="margin: 0">

    <div class="row">
        <div class="container col-8" style="margin-left: 1em;">
            <!--            <img src="/img/mobile-phone.jpg" class="img-fluid" alt="Responsive image">-->
            <h1 class="display-4">Fluid jumbotron</h1>
            <p class="lead">This is a modified jumbotron that occupies the entire horizontal space of its parent.</p>
        </div>

        <div class="container col-4" style="margin-right: 1em;">
            <!--Begin current conditions section-->
            <section class="container shadow-lg" style="border: 1px solid black">
                <div class="row">
                    <div class="col-8">
                        <p id="current-temperature">ph_73&#176</p>
                        <p id="current-description">ph_Partly Cloudy</p>
                        <p id="current-feels-like">ph_Feels like 73&#176</p>
                        <p id="day-night-temp">ph_Day 78&#176 &bullet; Night 68&#176</p>
                    </div>

                    <div class="col-4">
                        <img src="" alt="weather icon">
                    </div>
                </div>

            </section>
            <!--End current conditions section-->
        </div>
    </div>


</div>

<nav class="navbar navbar-expand-lg navbar-dark bg-primary" style="margin-bottom: 1em">
    <a class="navbar-brand" href="#">Navbar</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
                <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">Link</a>
            </li>
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Dropdown
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                    <a class="dropdown-item" href="#">Action</a>
                    <a class="dropdown-item" href="#">Another action</a>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#">Something else here</a>
                </div>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
            </li>
        </ul>
        <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
    </div>
</nav>


        <div class="container d-flex flex-row">
            <div class="card shadow">
                <div class="d-flex flex-column align-items-center">
                    <p id="day0" class="card-heading">Date</p>
                    <p><span id="day0-low"></span>F / <span id="day0-high"></span>F</p>
                    <img id="day0-icon" src="" alt="">
                    <div class="card-body">
                        <p>Description: <span id="day0-description" style="font-weight: bold"></span></p>
                        <p>Humidity: <span id="day0-humidity" style="font-weight: bold"></span></p>
                        <hr>
                        <p>Wind: <span id="day0-wind" style="font-weight: bold">5.84</span></p>
                        <hr>
                        <p>Pressure: <span id="day0-pressure" style="font-weight: bold"></span></p>
                    </div>
                </div>
            </div>

            <div class="card shadow">
                <div class="d-flex flex-column align-items-center">
                    <p id="day1" class="card-heading">Date</p>
                    <p><span id="day1-low"></span>F / <span id="day1-high"></span>F</p>
                    <img id="day1-icon" src="" alt="">
                    <div class="card-body">
                        <p>Description: <span id="day1-description" style="font-weight: bold"></span></p>
                        <p>Humidity: <span id="day1-humidity" style="font-weight: bold"></span></p>
                        <hr>
                        <p>Wind: <span id="day1-wind" style="font-weight: bold">5.84</span></p>
                        <hr>
                        <p>Pressure: <span id="day1-pressure" style="font-weight: bold"></span></p>
                    </div>
                </div>
            </div>

            <div class="card shadow">
                <div class="d-flex flex-column align-items-center">
                    <p id="day2" class="card-heading">Date</p>
                    <p><span id="day2-low"></span>F / <span id="day2-high"></span>F</p>
                    <img id="day2-icon" src="" alt="">
                    <div class="card-body">
                        <p>Description: <span id="day2-description" style="font-weight: bold"></span></p>
                        <p>Humidity: <span id="day2-humidity" style="font-weight: bold"></span></p>
                        <hr>
                        <p>Wind: <span id="day2-wind" style="font-weight: bold">5.84</span></p>
                        <hr>
                        <p>Pressure: <span id="day2-pressure" style="font-weight: bold"></span></p>
                    </div>
                </div>
            </div>

            <div class="card shadow">
                <div class="d-flex flex-column align-items-center">
                    <p id="day3" class="card-heading">Date</p>
                    <p><span id="day3-low"></span>F / <span id="day3-high"></span>F</p>
                    <img id="day3-icon" src="" alt="">
                    <div class="card-body">
                        <p>Description: <span id="day3-description" style="font-weight: bold"></span></p>
                        <p>Humidity: <span id="day3-humidity" style="font-weight: bold"></span></p>
                        <hr>
                        <p>Wind: <span id="day3-wind" style="font-weight: bold">5.84</span></p>
                        <hr>
                        <p>Pressure: <span id="day3-pressure" style="font-weight: bold"></span></p>
                    </div>
                </div>
            </div>

            <div class="card shadow">
                <div class="d-flex flex-column align-items-center">
                    <p id="day4" class="card-heading">Date</p>
                    <p><span id="day4-low"></span>F / <span id="day4-high"></span>F</p>
                    <img id="day4-icon" src="" alt="">
                    <div class="card-body">
                        <p>Description: <span id="day4-description" style="font-weight: bold"></span></p>
                        <p>Humidity: <span id="day4-humidity" style="font-weight: bold"></span></p>
                        <hr>
                        <p>Wind: <span id="day4-wind" style="font-weight: bold">5.84</span></p>
                        <hr>
                        <p>Pressure: <span id="day4-pressure" style="font-weight: bold"></span></p>
                    </div>
                </div>
            </div>
        </div>
        <br>
        <div id='map' style='width: 1075px; height: 600px; margin: auto'></div>

        <script src="js/keys.js"></script> <!--this needs to be listed first before other scripts-->
        <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
        <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
        <script src="js/mapbox-geocoder-utils.js"></script>
        <script>
            let mapLat = 29.674525;
            let mapLon = -97.959844;

            $('#find-button').click(function () {
                geocode($('#location-search').val(), MAPBOX_KEY).then(function(results) {
                    mapLon = results[0];
                    mapLat = results[1];
                    // console.log(mapLon);
                    // console.log(mapLat);
                });
                // $('#map').html("Test");
                map = new mapboxgl.Map({
                    container: 'map', // container ID
                    style: 'mapbox://styles/mapbox/streets-v11', // style URL
                    center: [mapLon, mapLat], // starting position [lng, lat]
                    zoom: 12 // starting zoom
                });
            });

            reverseGeocode({lat: mapLat, lng: mapLon}, MAPBOX_KEY).then(function(results) {
                $('#current-city').html(results.features[0].context[1].text);

            });

            mapboxgl.accessToken = MAPBOX_KEY;
            let map = new mapboxgl.Map({
                container: 'map', // container ID
                style: 'mapbox://styles/mapbox/streets-v11', // style URL
                center: [mapLon, mapLat], // starting position [lng, lat]
                zoom: 12 // starting zoom
            });



            $.get('https://api.openweathermap.org/data/2.5/onecall', {
                lat: mapLat,
                lon: mapLon,
                exclude: "minutely,hourly",
                units: "imperial",
                APPID: OPEN_WEATHER_KEY
            }).done(function (data) {
                console.log(data);

                let location;



                $('#day0').html(new Date(data.daily[0].dt * 1000));
                $('#day1').html(new Date(data.daily[1].dt * 1000));
                $('#day2').html(new Date(data.daily[2].dt * 1000));
                $('#day3').html(new Date(data.daily[3].dt * 1000));
                $('#day4').html(new Date(data.daily[4].dt * 1000));

                $('#day0-low').html("Low " + parseInt(data.daily[0].temp.min) + "&#176");
                $('#day0-high').html("High " + parseInt(data.daily[0].temp.max) + "&#176");

                $('#day1-low').html("Low " + parseInt(data.daily[1].temp.min) + "&#176");
                $('#day1-high').html("High " + parseInt(data.daily[1].temp.max) + "&#176");

                $('#day2-low').html("Low " + parseInt(data.daily[2].temp.min) + "&#176");
                $('#day2-high').html("High " + parseInt(data.daily[2].temp.max) + "&#176");

                $('#day3-low').html("Low " + parseInt(data.daily[3].temp.min) + "&#176");
                $('#day3-high').html("High " + parseInt(data.daily[3].temp.max) + "&#176");

                $('#day4-low').html("Low " + parseInt(data.daily[4].temp.min) + "&#176");
                $('#day4-high').html("High " + parseInt(data.daily[4].temp.max) + "&#176");


                $("#day0-icon").attr("src", "http://openweathermap.org/img/w/" + data.daily[0].weather[0].icon + ".png");
                $("#day1-icon").attr("src", "http://openweathermap.org/img/w/" + data.daily[1].weather[0].icon + ".png");
                $("#day2-icon").attr("src", "http://openweathermap.org/img/w/" + data.daily[2].weather[0].icon + ".png");
                $("#day3-icon").attr("src", "http://openweathermap.org/img/w/" + data.daily[3].weather[0].icon + ".png");
                $("#day4-icon").attr("src", "http://openweathermap.org/img/w/" + data.daily[4].weather[0].icon + ".png");

                $('#day0-description').html(data.daily[0].weather[0].description);
                $('#day1-description').html(data.daily[1].weather[0].description);
                $('#day2-description').html(data.daily[2].weather[0].description);
                $('#day3-description').html(data.daily[3].weather[0].description);
                $('#day4-description').html(data.daily[4].weather[0].description);

                $('#day0-humidity').html(parseInt(data.daily[0].humidity));
                $('#day1-humidity').html(parseInt(data.daily[1].humidity));
                $('#day2-humidity').html(parseInt(data.daily[2].humidity));
                $('#day3-humidity').html(parseInt(data.daily[3].humidity));
                $('#day4-humidity').html(parseInt(data.daily[4].humidity));

                $('#day0-wind').html(parseFloat(data.daily[0].wind_speed));
                $('#day1-wind').html(parseFloat(data.daily[1].wind_speed));
                $('#day2-wind').html(parseFloat(data.daily[2].wind_speed));
                $('#day3-wind').html(parseFloat(data.daily[3].wind_speed));
                $('#day4-wind').html(parseFloat(data.daily[4].wind_speed));

                $('#day0-pressure').html(parseInt(data.daily[0].pressure));
                $('#day1-pressure').html(parseInt(data.daily[1].pressure));
                $('#day2-pressure').html(parseInt(data.daily[2].pressure));
                $('#day3-pressure').html(parseInt(data.daily[3].pressure));
                $('#day4-pressure').html(parseInt(data.daily[4].pressure));
            });
        </script>
    </body>
</html>